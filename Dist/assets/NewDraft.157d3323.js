import{E as k}from"./style.b3f9040c.js";import{s as F,n as h,c as y}from"./vue.runtime.esm-bundler.f8c53bbe.js";import{H as x}from"./Header.9b62e6ea.js";import{ab as E,bx as C,az as D,B as n,r as i,o as N,e as L,d as u,w as m,h as v,b as V,M as A,bw as f}from"./index.333103f5.js";const U=["revoke","next","-","bold","underline","italic","image","-","strikeThrough","title","sub","sup","quote","unorderedList","orderedList","-","codeRow","code","link","table","=","pageFullscreen","fullscreen","preview","htmlPreview","catalog"];function q(){document.getElementsByClassName("md-editor-toolbar-item")[5].addEventListener("click",()=>{document.querySelector(".md-dropdown").classList.remove("md-dropdown-hidden")}),document.getElementsByClassName("md-editor-toolbar-item")[16].addEventListener("click",()=>{document.querySelector(".md-dropdown").classList.remove("md-dropdown-hidden")})}const z={class:"newdraft"},I={class:"container padding"},P=E({__name:"NewDraft",setup(M){const _=F.parse("token"),a=C();D(()=>{q()});const r=n(""),l=n(""),p=n(""),g=n(U),o=n(!1),w=async()=>{if(o.value=!0,f(l.value)){a.error("\u8BF7\u586B\u5199\u6807\u9898"),o.value=!1;return}else if(f(r.value)){a.warning("\u8BF7\u586B\u5199\u5185\u5BB9"),o.value=!1;return}const e=await h(l.value,r.value,"open","",p.value,"");e.data.code===201&&(p.value=e.data.data.insertId),e.data.code==200||e.data.code==201?a.success(e.data.message):a.error(e.data.message),o.value=!1},b=(e,t)=>{let d=new FormData;d.append("avatar",e[0]),y.post("/apis/user/upload?cookie="+_.token,d,{headers:{"Content-Type":"multipart/form-data"}}).then(s=>{a.success(s.data.message),t(["//"+s.data.data])}).catch(s=>{a.error("\u4E0A\u4F20\u5931\u8D25")})};return(e,t)=>{const d=i("n-input"),s=i("n-button"),B=i("n-space");return N(),L("div",z,[u(x,null,{default:m(()=>[v("\u7F16\u8F91\u8349\u7A3F")]),_:1}),V("div",I,[u(B,{vertical:""},{default:m(()=>[u(d,{size:"large",value:l.value,"onUpdate:value":t[0]||(t[0]=c=>l.value=c),placeholder:"\u8BF7\u8F93\u5165\u6587\u7AE0\u6807\u9898 \u5FC5\u586B"},null,8,["value"]),u(A(k),{modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=c=>r.value=c),onOnUploadImg:b,theme:"dark",toolbars:g.value},null,8,["modelValue","toolbars"]),u(s,{loading:o.value,block:"",type:"primary",size:"large",onClick:w},{default:m(()=>[v(" \u4FDD\u5B58\u8349\u7A3F ")]),_:1},8,["loading"])]),_:1})])])}}});export{P as default};
